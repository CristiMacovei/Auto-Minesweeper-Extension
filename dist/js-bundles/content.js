(()=>{"use strict";var e;!function(e){e[e.UNCOVERED=-1]="UNCOVERED",e[e.FLAG=-2]="FLAG",e[e.REVEAL_0=0]="REVEAL_0",e[e.REVEAL_1=1]="REVEAL_1",e[e.REVEAL_2=2]="REVEAL_2",e[e.REVEAL_3=3]="REVEAL_3",e[e.REVEAL_4=4]="REVEAL_4",e[e.REVEAL_5=5]="REVEAL_5",e[e.REVEAL_6=6]="REVEAL_6",e[e.REVEAL_7=7]="REVEAL_7",e[e.REVEAL_8=8]="REVEAL_8"}(e||(e={}));var t=function(){return t=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},t.apply(this,arguments)};function n(t){if(t){if(t.includes("red"))return e.FLAG;var n=t.split(" ")[1];switch(n){case"blank":return e.UNCOVERED;case"bombflagged":return e.FLAG;case"open0":return e.REVEAL_0;case"open1":return e.REVEAL_1;case"open2":return e.REVEAL_2;case"open3":return e.REVEAL_3;case"open4":return e.REVEAL_4;case"open5":return e.REVEAL_5;case"open6":return e.REVEAL_6;case"open7":return e.REVEAL_7;case"open8":return e.REVEAL_8;default:return console.log("[Warn] Unknown state found: ".concat(n)),null}}}function o(e,t,n,o){return[{deltaRow:-1,deltaCol:0},{deltaRow:-1,deltaCol:1},{deltaRow:0,deltaCol:1},{deltaRow:1,deltaCol:1},{deltaRow:1,deltaCol:0},{deltaRow:1,deltaCol:-1},{deltaRow:0,deltaCol:-1},{deltaRow:-1,deltaCol:-1}].map((function(n){var o=n.deltaRow,r=n.deltaCol;return{row:e+o,col:t+r}})).filter((function(e){var t=e.row,r=e.col;return 0<t&&t<n&&0<r&&r<o}))}window.addEventListener("load",(function(r){return l=void 0,a=void 0,c=function(){var r,l,a;return function(e,t){var n,o,r,l,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return l={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function i(l){return function(i){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&l[0]?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,o=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){a.label=l[1];break}if(6===l[0]&&a.label<r[1]){a.label=r[1],r=l;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(l);break}r[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],o=0}finally{n=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}}(this,(function(i){return r=function(){for(var e=Array.from(document.querySelectorAll("div.square")),t=-1,n=-1,o=e.map((function(e){var o=e.id.split("_").map((function(e){return parseInt(e)})),r=o[0],l=o[1];return r>=t&&(t=r+1),l>=n&&(n=l+1),{div:e,row:r,col:l}})),r=[],l=0;l<t;++l){r.push([]);for(var a=0;a<n;++a)r[l].push(null)}return o.forEach((function(e){r[e.row][e.col]={tileDiv:e.div}})),{matrix:r,numRows:t-1,numCols:n-1}}(),console.log("Loaded tiles: ",r),l=document.getElementById("face"),a="",setInterval((function(){if(!l.className.includes("facedead")&&!l.className.includes("faceooh")){r.matrix.forEach((function(e){return e.forEach((function(e){e.tileDiv.classList.remove("red"),e.tileDiv.classList.remove("green")}))}));var i=(u=r.matrix,s=r.numRows,f=r.numCols,[].concat(function(r,l,a){for(var i=[],c=function(c){for(var u=function(u){var s=n(r[c][u].tileDiv.className);if(null!==s&&s>=0){var f=o(c,u,l,a).map((function(e){return{pos:e,tileDiv:r[e.row][e.col].tileDiv}})),v=f.filter((function(e){return e.tileDiv.className.includes("red")}));v.length>0&&console.log(v);var p=f.filter((function(t){return n(t.tileDiv.className)===e.FLAG})),E=f.filter((function(t){return n(t.tileDiv.className)===e.UNCOVERED}));E.length>0&&p.length===s&&(i=i.concat(E.map((function(e){var n=e.pos,o=e.tileDiv;return t(t({type:"reveal"},n),{tileDiv:o,reason:"(".concat(c,", ").concat(u,") fully flagged")})}))))}},s=1;s<a;++s)u(s)},u=1;u<l;++u)c(u);return i}(u,s,f)).concat(function(r,l,a){for(var i=[],c=function(c){for(var u=function(u){var s=n(r[c][u].tileDiv.className);if(null!==s&&s>=0){var f=o(c,u,l,a).map((function(e){return{pos:e,tileDiv:r[e.row][e.col].tileDiv}})),v=f.filter((function(t){return n(t.tileDiv.className)===e.FLAG})),p=f.filter((function(t){return n(t.tileDiv.className)===e.UNCOVERED})),E=s-v.length;p.length>0&&p.length===E&&(i=i.concat(p.map((function(e){var n=e.pos,o=e.tileDiv;return t(t({type:"flag"},n),{tileDiv:o,reason:"(".concat(c,", ").concat(u,") not flagged")})}))))}},s=1;s<a;++s)u(s)},u=1;u<l;++u)c(u);return i}(u,s,f)).concat(function(r,l,a){for(var i,c,u=[],s=function(s){for(var f=function(f){var v=n(r[s][f].tileDiv.className);if(null!==v&&v>=0){var p=o(s,f,l,a).map((function(e){return{pos:e,tileDiv:r[e.row][e.col].tileDiv}})),E=p.filter((function(t){return n(t.tileDiv.className)===e.FLAG})),d=p.filter((function(t){return n(t.tileDiv.className)===e.UNCOVERED})),m=v-E.length;if(2===d.length&&1===m){var w=d[0],R=d[1],h=w.pos.row-R.pos.row,D=w.pos.col-R.pos.col;if(Math.abs(h)+Math.abs(D)!==1)return{value:void 0};for(var L=function(v){var p=w.pos.row+h*v,E=w.pos.col+D*v;if(0<p&&p<l&&0<E&&E<a&&n(null===(c=null===(i=r[p][E])||void 0===i?void 0:i.tileDiv)||void 0===c?void 0:c.className)===e.UNCOVERED){var d=p,m=E;d-s==2?(--d,m=f):d-s==-2?(++d,m=f):m-f==2?(--m,d=s):m-f==-2&&(++m,d=s);var L=n(r[d][m].tileDiv.className);if(null!==L&&L>0){var A=o(d,m,l,a).map((function(e){return{pos:e,tileDiv:r[e.row][e.col].tileDiv}})),V=A.filter((function(t){return n(t.tileDiv.className)===e.FLAG})),g=A.filter((function(t){return n(t.tileDiv.className)===e.UNCOVERED})),y=L-V.length;y+1===g.length?g.forEach((function(e){e.pos.row===w.pos.row&&e.pos.col===w.pos.col||e.pos.row===R.pos.row&&e.pos.col===R.pos.col||u.push({row:p,col:E,tileDiv:r[p][E].tileDiv,type:"flag",reason:"1-2 from (".concat(s,",").concat(f,")")})})):1===y&&g.forEach((function(e){e.pos.row===w.pos.row&&e.pos.col===w.pos.col||e.pos.row===R.pos.row&&e.pos.col===R.pos.col||u.push(t(t({},e.pos),{tileDiv:r[p][E].tileDiv,type:"reveal",reason:"1-2 from (".concat(s,",").concat(f,")")}))}))}}},A=-2;A<=1;A+=3)L(A)}}},v=1;v<a;++v){var p=f(v);if("object"==typeof p)return p}},f=1;f<l;++f){var v=s(f);if("object"==typeof v)return v.value}return u}(u,s,f)));i.forEach((function(e){e.tileDiv?e.tileDiv.classList.add("flag"===e.type?"red":"green"):console.log("fucked up:",e)}));var c=i.map((function(e){return"".concat(e.type,"@$({move.row},").concat(e.col,")")})).join("+");i.length>0&&c!==a&&console.log("Found auto moves: ",i),a=c}var u,s,f}),50),[2]}))},new((i=void 0)||(i=Promise))((function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(n,o)}r((c=c.apply(l,a||[])).next())}));var l,a,i,c}))})();